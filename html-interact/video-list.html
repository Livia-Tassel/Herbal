<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="shortcut icon" href="../favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/common.css">
    <title>草药仙踪</title>
    <style>
        .wrapper {
            position: relative;
            flex-direction: column;
        }

        .wrapper .back {
            width: 281px;
            height: 79px;
            display: flex;
            justify-content: space-between;
            position: absolute;
            left: 40px;
            top: 27px;
        }

        .back .return-button {
            width: 43px;
            height: 79px;
            background-image: url(../pic/pic-ink@2x.png);
            background-size: 43px 79px;
            background-repeat: no-repeat;
            text-align: center;
            font-size: 24px;
            color: #FFFFFF;
            line-height: 30px;
            padding: 10px 9px;
        }

        .back .text-box {
            width: 220px;
            height: 79px;
            display: flex;
            flex-direction: column;
        }

        .back .text-box h2 {
            width: 220px;
            height: 25px;
            padding-top: 6px;
            line-height: 19px;
            font-size: 18px;
            color: #8B5634;
            text-align: left;
        }

        .back .text-box h3 {
            width: 220px;
            height: 21px;
            font-size: 14px;
            color: rgba(42, 42, 42, 0.4);
            text-align: left;
            line-height: 15px;
            padding-bottom: 5px;
            border-bottom: 1.5px solid #8B5634;
            display: inline-block;
            box-sizing: border-box;
            margin-top: 16px;
        }

        .nav {
            width: 750px;
            height: 40px;
            display: flex;
            justify-content: space-between;
            margin: 0 auto;
            margin-top: 116px;
            font-size: 18px;
            color: #8B5634;
            text-align: center;
            line-height: 40px;
        }

        .nav .box4 {
            width: 132px;
            height: 40px;
            background-image: url(../pic/interact/video/pic-box4.png);
        }

        .content {
            width: 917px;
            height: 586px;
            background-image: url(../pic/interact/video/svg-content.svg);
            margin: 0 auto;
            margin-top: 32px;
            display: flex;
            justify-content: space-between;
            z-index: 2;
            position: relative;
        }

        .content .flower {
            height: 586px;
            width: 56px;
            background-image: url(../pic/pic-goldflower.png);
            background-repeat: no-repeat;
            background-position: center center;
            background-size: 36px 36px;
        }

        .content .list {
            width: 805px;
            height: 490px;
            /* background-color: pink; */
            margin: auto 0;
            display: flex;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-content: space-between;
        }

        .content .list .box {
            width: 371px;
            height: 232px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-content: center;
        }

        .content .list .box img {
            width: 371px;
        }

        .content .list .box h2 {
            height: 24px;
            line-height: 24px;
            font-size: 24px;
            color: #8B5634;
            text-align: center;
        }

        .modal-overlay .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 30px;
            color: #8B5634;
            cursor: pointer;
            z-index: 10;
            font-weight: bold;
            line-height: 1;
        }

        .img-herb {
            position: absolute;
            width: 247px;
            height: 399px;
            opacity: 0.17;
            background-image: url(../pic/soul/test/pic-herb.png);
            top: 0px;
            right: 0px;
            z-index: 1;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <div class="img-herb"></div>
        <div class="back">
            <a href="../interact.html">
                <div class="return-button">返回</div>
            </a>
            <div class="text-box">
                <h3>趣味互动</h3>
                <h2>百草解说</h2>
            </div>
        </div>
        <div class="nav">
            <a href="javascript:void(0)" onclick="openPoster(0)">
                <div class="box4">连翘</div>
            </a>
            <a href="javascript:void(0)" onclick="openPoster(1)">
                <div class="box4">金银花</div>
            </a>
            <a href="javascript:void(0)" onclick="openPoster(2)">
                <div class="box4">苦杏仁</div>
            </a>
            <a href="javascript:void(0)" onclick="openPoster(3)">
                <div class="box4">黄芩</div>
            </a>
        </div>
        <div class="content">
            <div class="flower"></div>
            <div class="list" id="herb-list">
                <!-- Dynamically populated or Static with clicks -->
                <div class="box">
                    <a href="javascript:void(0)" onclick="openVideo(0)"><img src="../pic/interact/video/1-连翘.png"
                            alt=""></a>
                    <h2>连翘</h2>
                </div>
                <div class="box">
                    <a href="javascript:void(0)" onclick="openVideo(1)"><img src="../pic/interact/video/2-金银花.png"
                            alt=""></a>
                    <h2>金银花</h2>
                </div>
                <div class="box">
                    <a href="javascript:void(0)" onclick="openVideo(2)"><img src="../pic/interact/video/3-苦杏仁.png"
                            alt=""></a>
                    <h2>苦杏仁</h2>
                </div>
                <div class="box">
                    <a href="javascript:void(0)" onclick="openVideo(3)"><img src="../pic/interact/video/4-黄岑.png"
                            alt=""></a>
                    <h2>黄芩</h2>
                </div>
            </div>
            <div class="flower"></div>
        </div>
    </div>

    <!-- Video Modal -->
    <div class="modal-overlay" id="videoModal">
        <div class="modal-content video-content">
            <div class="close-btn" onclick="closeModal('videoModal')">×</div>
            <div class="video-box">
                <video id="modalVideo" width="100%" height="100%"></video>
                <div class="ctrl-layer" id="ctrlLayer">
                    <div class="center-btn" id="playPauseBtn">
                        <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                            <path
                                d="M40.0009 2.95996C19.6289 2.95996 2.96094 19.632 2.96094 40C2.96094 60.368 19.6289 77.04 40.0009 77.04C60.3729 77.04 77.0409 60.372 77.0409 40C77.0409 19.628 60.3689 2.95996 40.0009 2.95996ZM40.0009 73.952C21.3289 73.952 6.04894 58.672 6.04894 40C6.04894 21.328 21.3289 6.04796 40.0009 6.04796C58.6729 6.04796 73.9529 21.328 73.9529 40C73.9529 58.672 58.6729 73.952 40.0009 73.952Z"
                                fill="white" />
                            <path
                                d="M51.6193 34.7201L38.9993 26.4801C34.7393 23.6801 31.1113 25.5481 31.1113 30.6761V49.3161C31.1113 54.4441 34.5793 56.3081 38.9993 53.5121L51.6193 45.2801C55.8793 42.1721 55.8793 37.5121 51.6193 34.7121V34.7201Z"
                                fill="white" />
                        </svg>
                    </div>
                </div>
                <!-- Custom Progress Bar -->
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            <h2 id="modalTitle"></h2>
            <h3 id="modalDesc"></h3>
        </div>
    </div>

    <!-- Poster Modal -->
    <div class="modal-overlay" id="posterModal">
        <div class="modal-content poster-content">
            <!-- 新的关闭按钮，使用SVG图标 -->
            <button class="close-btn" onclick="closeModal('posterModal')">
                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M15 30C6.72 30 0 23.28 0 15C0 6.72 6.72 0 15 0C23.28 0 30 6.72 30 15C30 23.28 23.28 30 15 30ZM15 1.425C7.53 1.425 1.425 7.53 1.425 15C1.425 22.47 7.515 28.575 15 28.575C22.485 28.575 28.575 22.485 28.575 15C28.575 7.515 22.47 1.425 15 1.425Z"
                        fill="#845241" />
                    <path
                        d="M16.0809 15L21.7959 9.28504C22.0809 9.00004 22.0809 8.53504 21.7959 8.20504L21.7509 8.16004C21.4659 7.87504 21.0009 7.87504 20.7159 8.16004L15.0009 13.92L9.28594 8.20504C9.00094 7.92004 8.53594 7.92004 8.25094 8.20504L8.20594 8.25004C7.92094 8.53504 7.92094 9.00004 8.20594 9.33004L13.9209 15L8.20594 20.715C7.92094 21 7.92094 21.465 8.20594 21.795L8.25094 21.84C8.53594 22.125 9.00094 22.125 9.28594 21.84L15.0009 16.08L20.7159 21.795C21.0009 22.08 21.4659 22.08 21.7509 21.795L21.7959 21.75C22.0809 21.465 22.0809 21 21.7959 20.67L16.0809 15Z"
                        fill="#845241" />
                </svg>
            </button>
            <img id="modalPoster" src="" alt="Poster">
        </div>
    </div>



    <style>
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            /* Dark background */
            z-index: 1000;
            display: none;
            /* Hidden by default */
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            position: relative;
            background: #E8DBBD url(../pic/pic-background.png);
            /* Theme color + Texture */
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* Video Pop Content Size - Matched to video.html logical size but scaled down slightly if needed */
        .video-content {
            width: 960px;
            /* height: auto; */
            padding: 40px;
            box-sizing: border-box;
            background: #E8DBBD url(../pic/pic-background.png);
        }

        /* Updated Poster Content Size */
        .poster-content {
            width: 688px;
            height: 721px;
            background-image: url(../pic/interact/video/pic-window.png);
            background-repeat: no-repeat;
            background-size: 100% 100%; /* 确保背景图完全填充指定尺寸 */
            background-position: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            background-color: transparent; /* 确保没有背景色 */
            box-shadow: none; /* 移除阴影 */
            padding: 0; /* 移除内边距 */
            max-width: none; /* 移除最大宽度限制 */
            max-height: none; /* 移除最大高度限制 */
            overflow-y: hidden; /* 防止内容溢出时出现滚动条 */
            /* text-align: center; 可以移除，因为 flex 布局已经处理了内容居中 */
        }

        .poster-content .close-btn {
            width: 30px; /* 新宽度 */
            height: 30px; /* 新高度 */
            padding: 0; /* 新内边距 */
            border: none; /* 移除边框 */
            background: transparent; /* 移除背景 */
            line-height: 0; /* 确保SVG垂直对齐 */
            top: 94px; /* 新的顶部定位 */
            right: 108px; /* 新的右侧定位 */
            position: absolute;
            /* 覆盖通用 .close-btn 样式中与SVG无关的属性 */
            font-size: 0; /* 隐藏可能存在的文字“x” */
            color: transparent; /* 确保文字颜色透明 */
            font-weight: normal; /* 移除粗体 */
            cursor: pointer;
        }

        /* 确保关闭按钮内的SVG正确显示 */
        .poster-content .close-btn svg {
            display: block;
        }

        /* 针对 poster 弹窗内图片的样式 */
        .poster-content img#modalPoster { /* 使用ID选择器提高特异性 */
            width: 370px; /* 新宽度 */
            margin: 104px 138px 65px 150px; /* 新外边距 */

            /* 覆盖原有的冲突样式 */
            max-width: none;
            max-height: none;
            border-radius: 0; /* 移除圆角 */
            box-shadow: none; /* 移除阴影 */
        }


        /* Reusing Video CSS from video.html with tweaks */
        .video-box {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            background: #000;
        }

        .video-content h2 {
            font-size: 26px;
            color: #8B5634;
            margin-top: 20px;
            text-align: left;
        }

        .video-content h3 {
            font-size: 16px;
            /* Slightly smaller for popup text */
            color: #535151;
            line-height: 1.6;
            text-align: left;
            margin-top: 10px;
        }

        /* Player Controls */
        .ctrl-layer {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            transition: background .3s;
        }

        .ctrl-layer.paused {
            background: rgba(0, 0, 0, .55);
        }

        .center-btn {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(1);
            cursor: pointer;
            opacity: 0;
            transition: opacity .3s, transform .3s;
        }

        .ctrl-layer.paused .center-btn {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.1);
        }

        .center-btn:hover {
            transform: translate(-50%, -50%) scale(1.2);
        }

        .progress-bar {
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, .25);
            cursor: pointer;
        }

        .progress-fill {
            height: 100%;
            width: 0;
            background: #8B5634;
            transition: width .1s;
        }
    </style>

    <script>
        // Data Configuration
        const herbs = [
            {
                name: "连翘",
                video: "../pic/interact/video/视频1-连翘.mp4",
                poster: "../pic/interact/video/连翘.jpg",
                desc: "连翘为木犀科植物连翘的干燥果实，主产于我国北方地区。其性微寒，味苦，归肺、心、小肠经，具有清热解毒、消肿散结、疏散风热的功效，被誉为“疮家圣药”。常用于治疗风热感冒、温病初起、高热烦渴、痈疽瘰疬等症。"
            },
            {
                name: "金银花",
                video: "../pic/interact/video/视频2-金银花.mp4",
                poster: "../pic/interact/video/金银花.jpg",
                desc: "金银花为忍冬科植物忍冬的干燥花蕾或初开的花，性寒味甘，归肺、心、胃经。其功效以清热解毒、疏散风热为主，兼能凉血止痢。常用于解热毒、痈肿疔疮、风热感冒、温病发热等症。"
            },
            {
                name: "苦杏仁",
                video: "../pic/interact/video/视频3-苦杏仁.mp4",
                poster: "../pic/interact/video/苦杏仁.jpg",
                desc: "苦杏仁为蔷薇科植物山杏、西伯利亚杏等的干燥成熟种子，性微温味苦，有小毒，归肺、大肠经。本品降气止咳平喘、润肠通便。苦杏仁含苦杏仁苷等成分，其在体内分解产生的微量氢氰酸可抑制呼吸中枢而镇咳平喘，须炮制以减毒性。"
            },
            {
                name: "黄芩",
                video: "../pic/interact/video/视频4-黄岑.mp4", // Note: Filename typo '黄岑'
                poster: "../pic/interact/video/黄岑.jpg",     // Likely same typo in jpg
                desc: "黄芩是唇形科植物黄芩的干燥根，性寒味苦，归肺、胆、脾、大肠、小肠经。本品清热燥湿、泻火解毒、止血安胎，尤善清上焦肺热及中焦湿热。常用于湿温暑湿、肺热咳嗽、高热烦渴、黄疸泻痢等症。"
            }
        ];

        // Player Elements
        const v = document.getElementById('modalVideo');
        const box = document.getElementById('ctrlLayer');
        const btn = document.getElementById('playPauseBtn');
        const bar = document.getElementById('progressBar');
        const fill = document.getElementById('progressFill');

        // Functions
        function openVideo(index) {
            const data = herbs[index];
            document.getElementById('modalTitle').innerText = data.name;
            document.getElementById('modalDesc').innerText = data.desc;
            v.src = data.video;

            document.getElementById('videoModal').style.display = 'flex';
            // Default: Paused state
            box.classList.add('paused');
        }

        function openPoster(index) {
            const data = herbs[index];
            document.getElementById('modalPoster').src = data.poster;
            document.getElementById('posterModal').style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            if (modalId === 'videoModal') {
                v.pause();
                v.src = ""; // Stop buffering
                box.classList.add('paused'); // Reset UI
            }
        }

        // Custom Player Logic from video.html
        function toggle(e) {
            e.stopPropagation();
            if (v.paused) { v.play(); } else { v.pause(); }
        }

        box.addEventListener('click', toggle);
        btn.addEventListener('click', toggle);

        v.addEventListener('play', () => box.classList.remove('paused'));
        v.addEventListener('pause', () => box.classList.add('paused'));

        v.addEventListener('timeupdate', () => {
            if (v.duration) {
                fill.style.width = (v.currentTime / v.duration * 100).toFixed(2) + '%';
            }
        });

        bar.addEventListener('click', e => {
            if (v.duration) {
                v.currentTime = e.offsetX / bar.offsetWidth * v.duration;
            }
        });

        // Optional: Close modal on outside click
        window.onclick = function (event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.style.display = "none";
                if (event.target.id === 'videoModal') {
                    v.pause();
                    v.src = "";
                    box.classList.add('paused');
                }
            }
        }
    </script>
</body>

</html>